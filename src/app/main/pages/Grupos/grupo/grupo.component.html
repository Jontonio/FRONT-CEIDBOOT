<div class="main">
  <div class="mb-2">
    <p-toolbar>
      <div class="p-toolbar-group-start">
        <h2>Grupos</h2>
      </div>
      <div class="p-toolbar-group-right">
        <button pButton
            pRipple
            type="button"
            icon="pi pi-plus"
            label="Nuevo Horario"
            (click)="openModal()"
            class="p-button-raised p-button-c"></button>
      </div>
    </p-toolbar>
  </div>
  <div class="grid content">
    <div class="col-12 md:col-4">
      <p-card>
        <form [formGroup]="FormGrupo">
          <div>
            <h2 class="ml-2">Nuevo grupo</h2>
          </div>
          <div class="col">
            <label for="NombreGrupo" class="block mb-2">Nombre del grupo</label>
            <div class="p-inputgroup">
              <span class="p-inputgroup-addon"><i class="fa-solid fa-people-group"></i></span>
              <input id="NombreGrupo"
                    class="full-width input-form"
                    type="text"
                    autocomplete="off"
                    formControlName="NombreGrupo"
                    maxlength="40"
                    pInputText/>
            </div>
            <small *ngIf="NombreGrupo.hasError('pattern') && !NombreGrupo.hasError('required')"
                  class="p-error">Digite un nombre del grupo <strong>válido</strong></small>
            <small *ngIf="NombreGrupo.hasError('required') && NombreGrupo.dirty"
                  class="p-error">El campo nombre del grupo es <strong>requerido</strong></small>
          </div>
          <div class="col">
            <label for="DescGrupo" class="block mb-2">Descripción del grupo (opcional)</label>
            <textarea rows="5"
                      cols="30"
                      pInputTextarea
                      formControlName="DescGrupo"
                      maxlength="350"
                      class="full-width"></textarea>
            <small *ngIf="DescGrupo.hasError('required') && DescGrupo.dirty"
                  class="p-error">El campo descripción del grupo es <strong>requerido</strong></small>
          </div>
          <div class="flex justify-content-end mt-2">
            <p-button label="Registrar"
                      [icon]="loadHorario?'pi pi-spin pi-spinner':'pi pi-save'"
                      (click)="saveGrupo()"
                      styleClass="p-button mr-2 p-button-c"></p-button>
            <p-button label="Cancelar"
                      (click)="resetGrupo()"
                      styleClass="p-button p-button-c"></p-button>
          </div>
        </form>
      </p-card>
    </div>
    <div class="col-12 md:col-8">
      <p-card>
        <div class="grid content">
          <div class="col table-responsive">
            <p-table [value]="listGrupos" responsiveLayout="scroll">
              <ng-template pTemplate="header">
                  <tr>
                    <th>ID</th>
                    <th pSortableColumn="Nombres">Nombres <p-sortIcon field="Nombres"></p-sortIcon></th>
                    <th pSortableColumn="Celular">Celular <p-sortIcon field="Celular"></p-sortIcon></th>
                    <th pSortableColumn="Email">Email <p-sortIcon field="Email"></p-sortIcon></th>
                    <th>Estado</th>
                    <th>Operación</th>
                  </tr>
              </ng-template>
              <ng-template pTemplate="body" let-listDocentes let-rowIndex="rowIndex">
                  <tr>
                      <td>{{startPage  + (rowIndex+1)}}</td>
                      <td>{{listDocentes.Nombres | titlecase}} {{listDocentes.ApellidoPaterno | titlecase}} {{listDocentes.ApellidoMaterno | titlecase}}</td>
                      <td>{{listDocentes.Celular}}</td>
                      <td>{{listDocentes.Email | titlecase}}</td>
                      <td>
                        <p-button styleClass="p-button-sm p-button-c">Activo</p-button>
                      </td>
                      <td>
                        <button pButton
                                pRipple
                                type="button"
                                class="p-button-danger p-button-text">
                                <i class="pi pi-delete-left"></i> Eliminar</button>
                        <button pButton
                                pRipple
                                type="button"
                                class="p-button-text p-button-plain">
                                <i class="pi pi-pencil mr-2"></i> Editar</button>
                      </td>
                  </tr>
              </ng-template>
            </p-table>
            <div class="mt-4" *ngIf="resGetGrupo">
              <p-paginator [rows]="5"
                           [totalRecords]="resGetGrupo.count"
                           [rowsPerPageOptions]="[5,10,15,20]"
                           (onPageChange)="paginate($event)"></p-paginator>
            </div>
            <app-loadding *ngIf="loadding && !changePage && listGrupos.length==0" msg="Lista de docentes"></app-loadding>
            <app-lista-vacia *ngIf="listGrupos.length==0 && !loadding" msg="No se encontraron grupos registrados">
            </app-lista-vacia>
          </div>
        </div>
      </p-card>
    </div>
  </div>
</div>


<p-dialog header="Nuevo horario"
          [(visible)]="modalHorario"
          [modal]="true"
          [style]="{width: '50vw'}"
          [breakpoints]="{'960px': '85vw'}" [style]="{width: '32vw'}"
          [draggable]="false" [resizable]="false">
        <form [formGroup]="FormHorario">
          <div class="grid content">
            <div class="col-12 md:col-6">
              <label for="HoraInicio" class="block mb-2">
                <i class="fa-regular fa-clock"></i> Hora de inicio
              </label>
                <p-calendar [timeOnly]="true"
                            hourFormat="12"
                            inputId="timeonly"
                            formControlName="HoraInicio"></p-calendar><br>
              <small *ngIf="HoraInicio.hasError('pattern') && !HoraInicio.hasError('required')"
                    class="p-error">Digite una hora <strong>válida</strong></small>
              <small *ngIf="HoraInicio.hasError('required') && HoraInicio.dirty"
                    class="p-error">El de hora inicio es <strong>requerido</strong></small>
            </div>
            <div class="col-12 md:col-6">
              <label for="HoraFinal" class="block mb-2">
                <i class="fa-regular fa-clock"></i> Hora final
              </label>
              <p-calendar [timeOnly]="true"
                          hourFormat="12"
                          inputId="timeonly"
                          formControlName="HoraFinal"></p-calendar><br>
              <small *ngIf="HoraFinal.hasError('pattern') && !HoraFinal.hasError('required')"
                    class="p-error">Digite una hora <strong>válida</strong></small>
              <small *ngIf="HoraFinal.hasError('required') && HoraFinal.dirty"
                    class="p-error">El campo hora final es <strong>requerido</strong></small>
            </div>
          </div>
          <div class="col">
            <label for="Nombres" class="block mb-2">Descripción del horario (opcional)</label>
            <textarea rows="5"
                      cols="20"
                      pInputTextarea
                      maxlength="350"
                      class="full-width"
                      formControlName="DescHorario"></textarea>
          </div>
        </form>
        <ng-template pTemplate="footer">
          <p-button label="Registrar"
                    [icon]="loadHorario?'pi pi-spin pi-spinner':'pi pi-save'"
                    (click)="saveHorario()"
                    styleClass="p-button mr-2 p-button-c"></p-button>
          <p-button label="Cancelar"
                    (click)="resetHorario()"
                    styleClass="p-button p-button-c"></p-button>
        </ng-template>
</p-dialog>
<!-- A component that is used to show messages to the user. -->
<p-toast position="top-right"
         [breakpoints]="{'920px': {width: '85%', right: '0', left: '0', padding:'10px'}}"></p-toast>
